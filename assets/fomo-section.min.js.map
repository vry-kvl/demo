{
  "version": 3,
  "sources": ["../../app/scripts/common/function/fomo-notify.js", "../../app/scripts/fomo-section.js"],
  "sourcesContent": ["var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||\r\n                            window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\r\n\r\nvar cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame;\r\n\r\nclass fomoNotify extends HTMLElement {\r\n  constructor() {\r\n    super();\r\n    this.cookieTime = false;\r\n    this.admin = this.querySelector('template') ? false : true;\r\n    !this.admin && this.firstLoad();\r\n  }\r\n\r\n  getTimes(){\r\n    const current = new Date().getTime();\r\n    this.times = {\r\n      cookie: current + this.dataset.cookie*1000,\r\n      firstShow: current + this.dataset.firstShow*1000,\r\n      loop: current + this.dataset.loop*1000,\r\n      show: current + this.dataset.show*1000\r\n    }\r\n  }\r\n\r\n  countdown(time, callback){\r\n    this.deadline = time;\r\n    this.callback = callback;\r\n    this.startAnimationFrame = requestAnimationFrame(this.animationFrame.bind(this));\r\n  }\r\n\r\n  animationFrame(time, callback){\r\n    const currentTime = new Date().getTime();\r\n    const remain = this.deadline - currentTime;\r\n\r\n    if(remain >= 1000){\r\n      this.startAnimationFrame = requestAnimationFrame(this.animationFrame.bind(this));\r\n    }\r\n    else{\r\n      cancelAnimationFrame(this.startAnimationFrame);\r\n      this.callback();\r\n    }\r\n\r\n  }\r\n\r\n  async show(){\r\n    this.closest('.js-fomo-container').insertAdjacentElement('afterbegin', this);\r\n    this.checkForTemplate();\r\n\r\n    this.randomString();\r\n    this.randomProduct();\r\n    await this.randomNumber();\r\n\r\n    this.classList.add('active');\r\n    \r\n  }\r\n\r\n  close(){\r\n    this.classList.remove('active');\r\n  }\r\n\r\n  firstLoad(){\r\n    this.getTimes();\r\n\r\n    this.countdown(this.times.firstShow, ()=>{\r\n      this.onShow();\r\n    });\r\n  }\r\n\r\n  onShow(){\r\n    this.getTimes();\r\n\r\n    this.show();\r\n    this.countdown(this.times.show, ()=>{\r\n      this.onClose();\r\n    })\r\n  }\r\n\r\n  onClose(){\r\n    this.getTimes();\r\n    this.close();\r\n\r\n    this.countdown(this.times.loop, ()=>{\r\n      this.onShow();\r\n    })\r\n  }\r\n\r\n  checkForTemplate(){\r\n    const template = this.querySelector('template');\r\n\r\n    if(!template) return;\r\n    Array.from(template.content.children)?.forEach(child=>{\r\n      template.insertAdjacentElement('beforebegin', child);\r\n    })\r\n    template.remove();\r\n  }\r\n\r\n  getRandomNumber(min,max){\r\n    return Math.floor(Math.random() * (max - min + 1) ) + min\r\n  }\r\n\r\n  async randomNumber(){\r\n    const content = this.querySelectorAll('.js-fomo-number');\r\n    if(!content.length) return;\r\n\r\n    const arrayStoraged = await theme.get(this.dataset.id);\r\n    const arrayNumber = [];\r\n\r\n    if(!this.admin && !arrayStoraged){\r\n      this.cookieTime = this.times.cookie;\r\n    }\r\n\r\n    content.forEach(target=>{\r\n      const index = +target.dataset.index;\r\n      const randomMin = +target.dataset.randomMin;\r\n      const randomMax = +target.dataset.randomMax;\r\n      const oldValue = arrayStoraged ? arrayStoraged?.find(i=>i.index == index) : null;\r\n\r\n      let value = this.getRandomNumber(randomMin, randomMax);\r\n\r\n      if(!this.admin && oldValue){\r\n        const deviation = this.dataset.deviation;\r\n        let min = Math.round(oldValue - (oldValue * deviation/100))\r\n        let max = Math.round(oldValue + (oldValue * deviation/100))\r\n\r\n        if(min < randomMin || isNaN(min)){ min = randomMin; }\r\n        if(max > randomMax || isNaN(max)){ max = randomMax; }\r\n        if( max == min ){ max = randomMax; min = randomMin;}\r\n\r\n        value = this.getRandomNumber(min, max);\r\n      }\r\n      target.innerHTML = value;\r\n      arrayNumber.push({index: index, value: value})\r\n\r\n    })\r\n\r\n    theme.set(this.dataset.id, arrayNumber, this.cookieTime);\r\n  }\r\n\r\n  randomString(){\r\n    const content = this.querySelectorAll('.js-fomo-string');\r\n    if(!content.length) return;\r\n\r\n    content.forEach(target=>{\r\n      const strings = target.dataset.string.split(',');\r\n      const randomMin = 0;\r\n      const randomMax = strings.length-1;\r\n\r\n      let index = this.getRandomNumber(randomMin, randomMax);\r\n      target.innerHTML = strings[index];\r\n    })\r\n  }\r\n\r\n  randomProduct(){\r\n    const content = this.querySelectorAll('.js-fomo-product');\r\n    if(!content.length) return;\r\n\r\n    content.forEach(target=>{\r\n      const array = JSON.parse(this.querySelector(`[data-random-product=\"${target.dataset.index}\"]`).innerHTML);\r\n      const randomMin = 0;\r\n      const randomMax = array.length-1;\r\n\r\n      const index = this.getRandomNumber(randomMin, randomMax);\r\n      const product = array.find(i=>i.index == index);\r\n      if(!product) return;\r\n\r\n      target.innerHTML = product.title;\r\n      target.href = product.url;\r\n\r\n      if(this.querySelector('img')){\r\n        const imageOld = this.querySelector('img');\r\n        const imageNew = document.createElement('img');\r\n        imageNew.src = product.image;\r\n        imageNew.className = imageOld.className;\r\n        imageOld.replaceWith(imageNew);\r\n      }\r\n    })\r\n  }\r\n}\r\ncustomElements.define('fomo-item', fomoNotify);\r\n", "import './common/function/fomo-notify';\r\n\r\nregister('fomo-section', {\r\n\tonLoad: function(){\r\n\t}\r\n\t,onUnload: function(){\r\n\r\n\t\tthis.container.querySelectorAll('.js-fomo')?.forEach(item=>{\r\n\t\t\titem.close();\r\n\t\t})\r\n\t}\r\n\t,onSelect: function(){\r\n\t}\r\n\t,onDeselect: function(){\r\n\t}\r\n\t,onBlockSelect: function(e){\r\n\t\te.target.show();\r\n\t\tthis.container.querySelectorAll('.js-fomo')?.forEach(item=>{\r\n\t\t\titem != e.target && item.close();\r\n\t\t})\r\n\t}\r\n\t,onBlockDeselect: function(e){\r\n\r\n\t\tthis.container.querySelectorAll('.js-fomo')?.forEach(item=>{\r\n\t\t\titem.close();\r\n\t\t})\r\n\t}\r\n});\r\n\r\nload('*');"],
  "mappings": "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",
  "names": []
}
